name: "Build & Test"

inputs:
  build_ubuntu_tarball:
    description: Whether or not to build an Ubuntu tarball for releasing
    required: true
    default: 'false'

outputs:
  release_archive:
    description: Archive of binaries and resources for distribution
    value: ${{ steps.release.outputs.archive }}

runs:
  using: "composite"
  steps:
    - name: Test Clojure CLI workflow
      shell: bash
      working-directory: ${{ github.workspace }}/clojure-cli
      run: ${{ github.workspace }}/clojure-cli/bin/ci/test
    - name: Test Leiningen plugin
      shell: bash
      working-directory: ${{ github.workspace }}/lein-jank
      run: ${{ github.workspace }}/lein-jank/bin/ci/test
